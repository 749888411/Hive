统一指标拆解规范

指标拆解是CBG数据底座oneData建设的重要一环，对规范指标数据定义，规避指标同名不同义，同义不同名，同义不同源问题，对底座原子指标建设有重要的指导意义。
本规范旨在提炼、规范指标拆解构成要素，阐释指标与底座数据建模的关系，归纳指标拆解的流程与规范，为拆解业务指标提供标准化参考。
统一指标拆解规范的意义
承上启下，无缝链接业务与数据Teradata Data Integration Roadmap（数据集成路线图）从技术的视角出发，自下而上揭示出数据价值业务变现的过程；从业务的视角出发，自上而下可划分出业务、需求、数据三层。
 
	业务层：企业肩负的使命和设定的愿景声明了业务发展的方针，同时企业战略层面的总体目标会细化成众多战术层面的业务提升机会，而业务提升机会的实现需要业务干系人的协同参与。
	需求层：业务提升机会的把握需要对具体的业务问题进行具体分析，指标和度量量化了业务问题的答案，维度丰富了观察业务问题的视角。换句话说，如果能将待解决的业务问题以及与之相关的指标、度量、维度描述清楚，实质上就已经清晰地描述了业务需求。
	数据层：指标、度量、维度的信息由数据模型提供，而数据模型由业务系统中的源数据填充。
综上所述，指标作为反映业务看待数据的方式，在数据价值业务变现的过程中起着承上启下的衔接作用。因此，以指标拆解为切入点驱动底座数据建模，在满足快速落地见效的同时又兼顾了日后的扩展。
	承上：指标反映业务看待数据的方式，可解答业务问题，评价业务提升机会及相关的业务单元和业务干系人的绩效，在业务上具有重要性。
	启下：以从业务报表中拆解出的原子指标为最小集，驱动在业务系统源数据上发现最大集，并指导底座数据建模，不仅具备技术可行性，加速了落地见效，还兼顾数据扩展性，可响应业务变化。
规范先行，驱动oneData体系建设

oneData体系的指导思想是围绕“四个统一”构建规范、可共享的底座公共数据，规避数据重复建设和开发资源浪费，提升应用交付效率。“四个统一”的核心是通过指标拆解确立统一指标数据规范，从而指导统一底座数据建模，构建统一看护体系，提供统一数据服务。
 
统一指标数据规范
	识别原子指标、衍生指标、复合指标及其之间的构成关系，每个指标都有明确的业务含义和技术口径，消除“同名不同义”和“同义不同名”。
	构建一致性逻辑维度和维度属性，每个指标都有与之相关的维度及维度属性，适用特定的业务场景和分析方式。
统一底座数据建模
	基于原子指标设计明细模型，构建最小粒度的事实表和一致性的维度表，向下灵活兼容业务系统的变更。
	基于衍生指标和复合指标设计公共汇总模型与应用汇总模型，平衡数据在存储和查询两方面的开销，向上快速响应用户需求的变化。 
统一看护体系
	提炼指标拆解规范，明晰数据的含义，提升业务的可读性。
	提炼模型设计规范，建立主题划分、词根命名、组织运作等标准，促进数据的重用，适配业务的扩展性；
	提炼元数据管理规范，维护指标构成关系与指标数据关系，增强对数据资产的管理，增加对业务应用的透明度。
统一数据服务
	规范对工具的使用，支撑经营&运营可视化、自助分析、挖掘洞察、数据服务消费等多种应用方式。
	规范对用户的服务，满足业务用户、业务分析师、数据科学家、数据管理员等多个角色的要求。

指标拆解的方法与规范
指标拆解过程要素及构成关系
要素解释
要素	解释

业务过程	业务过程是独立的、不可再拆分的业务活动，通常有相关的业务对象参与。
示例：门店销售，合同评审是两个独立的业务过程。

度量	度量是衡量业务过程状况的数值型数据，通常表现为不带业务含义的数字。度量只有在具体的业务过程下被赋予明确的业务含义后方能成为指标。
示例：金额、数量、周期是三类常见的度量。

属性	属性是描述业务对象特征的文本型数据，既可用来声明业务过程的粒度，也可作为维度和修饰词的来源。
示例：人员编号、门店状态、产品系列分别是业务对象人、店、物的属性。
原子指标/
原子指标数据	原子指标是某一业务过程下不可继续拆分的度量或者对属性的计数。例如，门店数量（count（门店编码））、门店销量（sum（销售IMEI））、驻店时长（离店时间-进店时间）
原子指标数据=原子指标+相关业务属性。

维度	维度是观察和分析业务过程的视角，来源于属性，也可视为对相关联的属性的聚类，部分维度具有层级结构。
示例：地理维度【国家-地区-省份-城市-门店地址】，时间维度【年-月-季-周-销售日期】，产品维度【品牌-系列-SKU】。

修饰词	修饰词是对特定的业务场景/口径的抽象，来源于属性或基于指标生成。修饰词通常用于过滤筛选，限定原子指标的统计范围。
例如，有效门店数量的“有效”来源于门店状态的取值；零销量门店数量的“零销量”基于门店销售数量为零生成。

衍生指标	衍生指标=原子指标数据+修饰词+维度，即衍生指标是基于原子指标数据添加修饰词的限定或维度取值的限定而生成的，并且一个衍生指标只能来源于一个原子指标数据，修饰词和维度均来源于原子指标数据中的属性。
示例：有效门店数量，零销量门店数量，中国区四季度Mate系列销售数量。
叠加公式	叠加公式是指标之间的计算逻辑，可以是简单的四则运算，也可以是复杂的数理统计。
示例：除法运算C=A/B，加权汇总C=∑Ai*Bi。

复合指标	复合指标=复合/衍生/原子指标+叠加公式，即复合指标是一个或多个复合/衍生/原子指标通过叠加公式计算生成。
示例：门店平均产能、门店库存周转天数、促销员门店覆盖率。
要素构成关系
 
以消费者BG零售业务中的【促销员门店覆盖率】指标为样例，说明原子指标数据、衍生指标、复合指标的相关定义： 
 
	原子指标：【门店数量】（对属性【门店编码】的计数）
	原子指标数据：【门店数量】+相关业务属性，其中属性为【门店等级】、【门店状态】、【门店形象等级】、【组织等级】等；
	维度：属性【组织编码】、【渠道编码】可作为组织、渠道维度；
	修饰词：【门店状态】等于“有效”；【有无促销员】 等于“1”；
	衍生指标：由原子指标数据通过添加修饰词、维度限定而成，如：【促销员覆盖门店数量】、【有效门店数量】；
	复合指标：由衍生指标叠加计算而成，如：【促销员门店覆盖率】=【促销员覆盖门店数量】÷【有效门店数量】。
管理规范
通过指标拆解得到的原子/衍生/复合指标的管理规范如下：

原子指标/原子指标数据：
  颗粒度&完整性：原子指标数据需保留业务系统源数据的最细粒度，并尽可能保留完整的业务属性，以适应未来的需求扩展。
  命名规范：由业务对象/过程+度量组成，例如：门店数量。
  管理规则：
	原子指标统一定义、建设、管理与运营，避免同名不同义、同义不同名、同义不同源； 
	原子指标需要在产品团队评审通过后在DAP发布，按照适用范围与数据密级的要求进行共享，不允许自定义生成。

衍生指标：
  命名规范：由维度取值+修饰词+原子指标来命名，例如：促销员覆盖门店数量、有效门店数量。
  管理规则：
	衍生指标统一定义、建设、管理与运营，避免同名不同义、同义不同名；
	一个衍生指标只能来源于一个原子指标数据，修饰词、维度均来源于原子指标数据中的属性或度量。
	衍生指标需要在产品团队评审通过后在DAP发布，按照适用范围与数据密级的要求进行共享，不允许自定义生成。

复合指标：
  命名规范：业务对象/过程+计算结果，如门店平均销量
  管理规则：
	复合指标统一定义、建设、管理与运营，避免同名不同义、同义不同名；
	复合指标需要在产品团队评审通过后在DAP发布，按照适用范围与数据密级的要求进行共享，不允许自定义生成。
	复合指标可由一个或多个复合/衍生/原子指标通过叠加公式计算生成。根据叠加计算的层次，复合指标又可分为一级复合指标和多级复合指标，如下图所示：
	一级复合指标：直接由原子指标或衍生指标经过叠加公式计算生成。
 
	多级复合指标：一级复合指标继续叠加计算，生成二级、三级等多级复合指标。
 

拆解过程常见情况及处理方式
	时间与时长：时长定义为原子指标，由时间计算而来，但时间不定义为指标。
	示例：原子指标预约/到店现场取机全流程TAT=消费者现场取机时间-消费者取号时间。
 
	价格与金额：XX价格与XX金额都定义为XX业务过程的原子指标，不因价格*数量=金额的运算关系而把金额定义为复合指标。
	示例：零售门店进货价和零售门店销售金额都是门店销售业务过程的原子指标。
 
	基线、目标、权重：基线、目标、权重都不定义为指标，仅作为参数参与指标的运算。
	示例：基线作为阈值参与判断TAT标准时长是否达标，成为修饰词的一部分作用于原子指标，从而生成衍生指标。
 	
	示例：海外单个订单冲销数量权重由原子指标订单冲销数量计算，用于对衍生指标海外单个订单产品供应周期加权求和，计算复合指标海外平均产品供应周期，因而权重仅参与指标运算的过程，而非指标运算的结果。
 
	业务场景/口径：业务场景/口径等同于修饰词，用于生成衍生指标。
	示例：衍生指标Sell Thru（ST-1）和Sell Thru（ST-Retailer）是从两个不同的角度切分原子指标Sell Thru，以匹配不同的分析应用场景。
 
	示例：零销量来源于原子指标销售数量，用于限定另一原子指标人员数量的统计范围。
 
	平均：平均定义为两个不同指标之间相除的叠加公式，用于生成复合指标。
	示例：复合指标督导人均访店次数由衍生指标督导实际访店次数和督导实际访店人数相除生成。
 

指标拆解过程要素与底座数据架构之间有着明确的对应关系，反映出以指标拆解为切入点驱动底座数据建模具备合理性和可行性。
	DWD层：原子指标数据对应在DWD层建设，遵循维度建模理论建立一致性维度数据和公共明细数据模型，保留贴源数据的最细粒度。
	DWS层：公用（多个业务指标都使用）、常用（多个业务报表都使用）的衍生指标和复合指标可以在DWS层建设，建立公共汇总/整合拉通数据模型，为DM层数据模型和BI层分析报表的开发提供便利。
	DM层：个性化（单个或少量业务指标和业务报表使用）、变动频繁（业务口径和技术口径不固定）的衍生指标和复合指标对应在DM层建设，基于DWD层和DWS层数据模型组装加工，面向具体的业务应用进行数据建模。

一、原子指标 
指标编码（系统自生成，模板无需填写）	标准指标名称（*必填）	指标定义（由BA和IA）（*必填）	所属主题域（*必填）	业务过程（非必填）	度量（*必填）	币别(非必填)	度量单位（*必填）	计算规则（*必填）	是否过程指标（*必填）	业务指标编码（是否过程指标为N时，必填；否则无需填写）			
1.系统自动生成原子指标数据编码 生成规则：原子指标：'YZ'开头+6位数字
样例：YZ123456

2.填写原子指标数据名称，要见名知意
该原子指标为业务指标，则沿用业务指标名称。
该原子指标为过程指标, 命名规范为：业务对象/动作+度量
样例：门店数量

3.填写原子指标的定义/描述，必须清晰表述业务含义，
若该原子指标为业务指标，继承业务指标字典上的指标定义。
若该原子指标为过程指标，则说明原子指标在哪一业务过程下，涉及的业务对象/动作，以及其度量。
样例：在零售领域下门店数量

4.所属DWR的主题域，选择参考值。
不允许自建，如有疑问，联系huangjingbo
样例：零售

5.填写该原子指标对应的业务过程；
原子指标必须填写清晰的业务过程；

6.选择该原子指标的度量；
不允许自建；如需新增，联系wangyun ，并在DAP维护好
样例：数量
参考值：时长 数量 金额 占比 均值 分数 评级

7.当选择金额度量时：
币别为必填项，选择对应的币别

8.选择度量单位：
不允许自建；如需新增，联系wangyun，并在DAP维护好
样例：个
参考值：秒 分 小时 天 周 工作日 PCS 万PCS 个 行 篇 起 本 次 单 人次 元 万元 百万元 亿元 % PPM NA 分 级

9.填写原子指标的具体计算方法，sum(数据标准的业务属性)、count(数据标准的业务属性)等	
样例：count(门店编码)

10.若该原子指标不是业务指标，是拆解过程中产生的指标。则该字段填写'Y'。
若该原子指标是业务指标，则该字段填写'N'
样例：Y	

11.若是否过程指标为'N',则该字段必填，填写业务指标编码。
						
													
二、衍生指标													
指标编码（系统自生成，模板无需填写）	标准指标名称（*必填）	指标定义（由BA和IA）（*必填）	所属主题域（*必填）	业务过程（非必填）	度量（*必填）	币别(非必填)	度量单位（*必填）	计算规则（口径/修饰词）（*必填）	来源指标编码（*必填）	是否过程指标（*必填）	业务指标编码（是否过程指标为N时，必填；否则无需填写）		
1.系统自动生成衍生指标数据编码
生成规则：衍生指标：原子指标编码+3位序列号，如YZ123456_001
样例：YZ123456_001


2.填写衍生指标数据名称，要见名知意
若该衍生指标为业务指标，则沿用业务指标名称。
若该衍生指标为过程指标,命名规范为：由口径/修饰词+原子指标来命名，例如：促销员覆盖门店数量、有效门店数量
样例：有效门店数量


3.填写衍生指标的定义/描述。
若该衍生指标为业务指标，继承业务指标字典上的指标定义。
若该衍生指标为过程指标，则说明衍生指标在哪一业务过程下，涉及的业务对象/动作，以及其度量，并且所用到的口径/修饰词的筛选条件或限定原子指标的限定范围。
样例：门店状况为有效的门店进行计数得到的门店数量


4.所属DWR的主题域，选择参考值。
不允许自建，如有疑问，联系huangjingbo
样例：零售

5.填写该衍生指标对应的业务过程；

6.选择该衍生指标的度量；
样例：数量

7.当选择金额度量时：
币别为必填项，选择对应的币别

8.选择度量单位：
样例：个

9.该衍生指标所用到的口径修饰词，以及规则。
口径/修饰词来源于属性或基于原子指标生成，通常用于过滤筛选，限定原子指标的统计范围识别。
如：修饰词1：门店状态=有效  必须拆分到属性，以及属性规则间的关系
样例：门店状态 = 有效

10.该衍生指标是由哪个原子指标生成，填写原子指标的编码
样例：YZ123456

11.若该原子指标不是业务指标，是拆解过程中产生的指标。则该字段填写'Y'。
若该原子指标是业务指标，则该字段填写'N'
样例：Y	

12.若是否过程指标为'N',则该字段必填，填写业务指标编码。	
	
		
样例2：YZ123456_002	促销员覆盖门店数量	有促销员的门店计数得到的门店数量	零售		数量		个	有促销员 =1  门店状态 = 有效	YZ123456	Y
													
三、复合指标													
指标编码（系统自生成，模板无需填写）	标准指标名称（*必填）	指标定义（由BA和IA）（*必填）	所属主题域（*必填）	业务过程（非必填）	度量（*必填）	币别(非必填)	度量单位（*必填）	计算规则(叠加公式）（*必填）	来源指标编码（*必填）	是否过程指标	业务指标编码（是否过程指标为N时，必填；否则无需填写）		

1.系统自动生成复合指标数据编码,
生成规则：复合指标：'FH'开头+6位数字序列


2.填写复合指标数据名称，要见名知意
若该复合指标为业务指标，则沿用业务指标名称。
若该复合指标为过程指标,命名规范为：业务对象/动作+计算结果，如门店平均销量

3.填写复合指标的定义/描述。
若该复合指标为业务指标，继承业务指标字典上的指标定义。
若该复合指标为过程指标，则说明该指标在哪一业务过程下，使用的衍生指标及叠加公式

4.所属DWR的主题域，选择参考值。
不允许自建，如有疑问，联系huangjingbo 

5.填写该衍生指标对应的业务过程；


6.选择该衍生指标的度量；


7.当选择金额度量时：
币别为必填项，选择对应的币别


8.选择度量单位：	


9.填写支撑该指标数据的叠加公式，公式中的指标数据编码需要与原子指标数据、衍生指标数据、复合指标数据编码一致。


10.该复合指标是由哪些指标生成，填写指标的编码，仅写该复合指标叠加公式出现的指标。(可多选)用分号隔开。	


11.若该原子指标不是业务指标，是拆解过程中产生的指标。则该字段填写'Y'。
若该原子指标是业务指标，则该字段填写'N'


12.若是否过程指标为'N',则该字段必填，填写业务指标编码。	
	
三、样例：FH123456	促销员门店覆盖率	促销员门店覆盖率	零售		占比		%	YZ123456_002/YZ123456_001	"YZ123456_001;
YZ123456_002"	N	YW123456		
